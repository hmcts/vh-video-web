<div>
  <div class="panel-container" [ngClass]="{ 'vh-twidth': !expandPanel }">
    <div class="govuk-grid-row govuk-!-margin-bottom-1">
      <div class="govuk-grid-column-full govuk-!-margin-top-2">
        <span *ngIf="expandPanel; else collapsePanel">
          <span class="govuk-!-margin-bottom-3 vh-expand">
            <img
              src="/assets/images/collapse.png"
              class="panel-icon icon-op"
              alt="Collapse panel icon"
              id="collapse-icon-id"
              (click)="toggleCollapseExpand()"
            />
          </span>
        </span>
        <ng-template #collapsePanel>
          <span class="govuk-!-margin-bottom-3 vh-collapse">
            <img
              src="/assets/images/expand.png"
              class="panel-icon icon-op"
              alt="Expand panel icon"
              id="expand-icon-id"
              (click)="toggleCollapseExpand()"
            />
          </span>
        </ng-template>
      </div>
    </div>

    <div class="govuk-table table-br" summary="Judge hearing participants panel">
      <div class="govuk-table_body">
        <div class="govuk-table_row vh-line" *ngFor="let participant of participants; let i = index">
          <div *ngIf="isParticipantInHearing(participant)">
            <div class="govuk-table_cell govuk-body-s--white vh-name" *ngIf="expandPanel">
              <span class="govuk-!-margin-bottom-3 govuk-!-margin-top-2 vh-panel-name">
                {{ participant.displayName }}
              </span>
            </div>
            <ng-container *ngIf="!isParticipantDisconnected(participant); else participantDisconnected">
              <div class="govuk-table_cell cell-icon">
                <span> </span>
                <span class="tooltip">
                  <span class="top" [ngClass]="{ 'tooltip-collapse': !expandPanel }">
                    {{ participant.displayName }}
                  </span>

                  <img
                    [src]="isMuteAll || participant.isMuted ? '/assets/images/mute-mic-red.png' : '/assets/images/mic.png'"
                    class="panel-icon"
                    [alt]="isMuteAll || participant.isMuted ? 'Microphone muted icon' : 'Microphone on icon'"
                    (click)="toggleMuteParticipant(participant)"
                  />
                </span>
              </div>
              <div class="govuk-table_cell cell-icon">
                <span *ngIf="participant.handRaised" class="tooltip">
                  <span class="top" [ngClass]="{ 'tooltip-collapse-hand': !expandPanel }"> Lower hand {{ participant.displayName }} </span>
                  <img
                    src="/assets/images/hand-yellow.png"
                    class="panel-icon"
                    alt="Hand on icon"
                    (click)="lowerParticipantHand(participant.participantId)"
                  />
                </span>
              </div>
              <div class="govuk-table_cell cell-icon">
                <app-participant-alert [participant]="mapParticipantToParticipantResponse(participant)"></app-participant-alert>
              </div>
            </ng-container>
            <ng-template #participantDisconnected>
              <div class="govuk-grid-row">
                <div class="govuk-grid-column-three-quarters">
                  <p class="disconnected">DISCONNECTED</p>
                </div>
                <div class="govuk-grid-column-one-quarter">
                  <span class="tooltip">
                    <img src="/assets/images/participant-disconnected.png" class="panel-icon" alt="participant disconnected" />
                  </span>
                </div>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
    <div class="govuk-grid-row govuk-!-margin-bottom-1">
      <div class="govuk-grid-column-full govuk-!-margin-top-2 govuk-!-margin-bottom-3" *ngIf="expandPanel; else buttonsCollapse">
        <button
          data-prevent-double-click="true"
          class="govuk-button grey-btn vh-mr"
          [ngClass]="{ muted: isMuteAll }"
          (click)="toggleMuteAll()"
        >
          {{ muteAllToggleText }}
        </button>
        <button class="govuk-button grey-btn" (click)="lowerAllHands()">Lower all hands</button>
      </div>
      <ng-template #buttonsCollapse>
        <div class="govuk-grid-column-full govuk-!-margin-top-2 govuk-!-margin-bottom-3">
          <span class="tooltip">
            <span class="top" [ngClass]="{ 'tooltip-collapse-btn': !expandPanel }">
              Mute all participants
            </span>
            <img src="/assets/images/mute-mic-red.png" class="panel-icon vh-mr-icon" alt="Microphon off icon" (click)="toggleMuteAll()" />
          </span>
          <span class="tooltip">
            <span class="top" [ngClass]="{ 'tooltip-collapse-btn': !expandPanel }">
              Lower all hands
            </span>
            <img src="/assets/images/no-hand.png" class="panel-icon" alt="Lower all hand icon" (click)="lowerAllHands()" />
          </span>
        </div>
      </ng-template>
    </div>
  </div>
</div>
